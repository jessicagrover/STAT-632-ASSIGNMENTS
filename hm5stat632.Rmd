---
title: "hm5stat632"
author: "Jessica Grover"
date: "4/1/2022"
output:
  word_document: default
  pdf_document: default
---

```{r}
hdi = read.csv("hdi2018.csv")
head(hdi)

```
#Problem 1
#a. Fit a multiple linear regression model with hdi 2018 as the response, and the other four variables as predictors.
```{r}
df<-hdi
model1<-lm(hdi_2018 ~median_age+pctpop65+pct_internet+pct_labour,data=df)
summary(model1)

```
#b. Using the model fit in (a), is there evidence of a relationship between hdi 2018 and at least one of the predictor variables? Write the null and alternative hypotheses, report the F-test statistic and p-value, and state your conclusion.
From the above model fit, we can see that the p-value of hdi_2018 is same for pct_internet predictor variable.
H0 : β1 = β2 = β3 = β4 = 0
HA : at least one βj != 0
We are rejecting predictor variable pct_labor because its p-value is 0.649 which is too high and is not significant.
```{r}
model2<-lm(hdi_2018 ~median_age+pctpop65+pct_internet,data=df)
summary(model2)

```



#c. Using the model fit in (a), which predictor variables are statistically significant according to the individual t-tests?

median_age and pct_internet are statiscally significant to the individual t-test.

```{r}
lm3<-lm(hdi_2018 ~median_age+pct_internet,data=df)
summary(lm3)
```


#d. Fit a reduced model with median age and pct internet as predictors. Use the anova() function to conduct a partial F-test that compares this reduced model with the full model specified in (a). Make sure to write the null and alternative hypotheses, report the p-value, and state your conclusion.

Reduced model is:
```{r}
model3<-lm(hdi_2018 ~median_age+pct_internet,data=df)
summary(model3)
```
Hypothesis test:
H0 : β1 = β2 = β3 = β4 = 0
HA : at least one βj != 0

```{r}
anova(model1,model3)
```

P-value is 2.2e-16 which is small so we are rejecting null hypothesis.

#e. According to the adjusted-R2, how does the full model in (a) compare with the reduced model in (d)? Is this consistent with your conclusion for the partial F-test?

```{r}
summary(model1)$adj.r.squared
summary(model3)$adj.r.squared
```

The adjusted R squared of both reduced model and full model is about the same but the reduced model is little higher. This agrees with the conclusion of F-test that the decision of removing pct_labour is correct.


-----------------------------------------------------------------------------------

#Problem 2
#a. Make a scatterplot matrix for the three variables. Describe the associations between the variables in the scatterplot matrix.
```{r}
pairs(hdi_2018 ~ median_age+ pct_internet , data=hdi)
```
#b. Make a plot of the residuals versus fitted values, and a QQ plot of the standardized residuals.
Residual vs fitted plot
```{r}
plot(model3,which = 1)
```
Standardized residual plot
```{r}
plot(model1,which = 2)
```

#c. Make a plot with the leverage values (hi) on the x-axis, and standardized residuals (ri) on the y-axis. Identify any points (countries) that have high standardized residuals or leverage.
```{r}
p <- 3
 n <- nrow(hdi)
plot(hatvalues(model3), rstandard(model3),
xlab='Leverage', ylab='Standardized Residuals')
 abline(v = 2*(p+1)/n, lty=2)
```
```{r}
ind <- which(hatvalues(model3) > 4/n)
hdi[ind, ]
```

#d.  Based on the scatterplot matrix and model diagnostics, do the assumptions for MLR appear adequately satisfied? Can you think of any ways in which the model might be improved to better fit the data?

```{r}
plot(model3)
```
From the above plots, all the assumptions of linearty are satisfied.



